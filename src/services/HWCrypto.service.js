const config = require('config');
const HWCrypto = require('assets/lib/hwcrypto.js');
const ASN1 = require('assets/lib/asn1.js');
const Hex = require('assets/lib/hex.js');

const { dappURL } = config;

class HWCryptoService {
  getCertificate(address) {
//    const HEX_TH = '308205F9308203E1A00302010202101B3C118E85355F8F5B1F729E29FB0866300D06092A864886F70D01010B05003063310B300906035504061302454531223020060355040A0C19415320536572746966697473656572696D69736B65736B75733117301506035504610C0E4E545245452D31303734373031333117301506035504030C0E4553544549442D534B2032303135301E170D3138303631323037313333345A170D3233303630383230353935395A3081CB310B300906035504061302454531243022060355040A0C1B4553544549442028444947492D494420452D5245534944454E5429311A3018060355040B0C116469676974616C207369676E61747572653132303006035504030C2943524F4953454155582C46414252494345204A45414E2D204D415249452C33363930333132303135333112301006035504040C0943524F495345415558311C301A060355042A0C1346414252494345204A45414E2D204D41524945311430120603550405130B33363930333132303135333076301006072A8648CE3D020106052B81040022036200042E5D30A48260629B0F9ACB59C519700D1D19B1D49303C33835B5549E3A7D4D10F358ADFB2F7AB1EFA993AAC4FAEAC249D42ACE8EF5FA516753272E3BED8E7872A75BDC151AED9E251141F83B66CBDFA4AC41DA89DB55026F7736FA92CAC020E3A38201EC308201E830090603551D1304023000300E0603551D0F0101FF04040302064030540603551D20044D304B303E06092B06010401CE1F01023031302F06082B06010505070201162368747470733A2F2F7777772E736B2E65652F7265706F7369746F6F7269756D2F4350533009060704008BEC400102301D0603551D0E04160414006015464B8EAED0F753C5ACC16A91F16997592F30818A06082B06010505070103047E307C3008060604008E4601013008060604008E4601043051060604008E46010530473045163F68747470733A2F2F736B2E65652F656E2F7265706F7369746F72792F636F6E646974696F6E732D666F722D7573652D6F662D6365727469666963617465732F1302454E3013060604008E4601063009060704008E46010601301F0603551D23041830168014B3AB88BC99D562A4852A08CDB41D723B83724751306A06082B06010505070101045E305C302706082B06010505073001861B687474703A2F2F6169612E736B2E65652F65737465696432303135303106082B060105050730028625687474703A2F2F632E736B2E65652F4553544549442D534B5F323031352E6465722E637274303C0603551D1F043530333031A02FA02D862B687474703A2F2F7777772E736B2E65652F63726C732F6573746569642F657374656964323031352E63726C300D06092A864886F70D01010B05000382020100C98527CF97A98AE3314B60E37C99184174E63493C638E13ECD715BCF58BC3E3B62B13EAD7FB5AA028A75DD03578498D8C1B515545DF4C9246FCCADBDF022B3F079A346BCEF483A09BFFD9A013A1E064D6F68B07AF9560A0AA176BE79A42BC0520C69E19B80495D8FBA1F0AF78BDF0794E3E70766F7C257D0B89C91F8DF1071C1415C7E746F81BF23747EA7C95DB88779735BD7D645C727BCF78C5548DEE05F056E984EBF4C12B7F32A4A0D95BEE71B297CBE79FD3CDE8FE07AD8C5D798F00F2681A713F6A685307559CBC791DFFA1D7ACCE7E80B713D7138674E51BA399DD1DDBA66C44389DE2836E8FD3B75F4256B9C17D8361D2C495595A3AF8A5EE8165BEBB20366952255B4D5464498C369E08498E03DAAB3C7AD1A1465BA8330B12B4EE25F9584733A7F5863ED9171139F829B67324ADB9BE5DD97F448D93C4EC72FAD5A482D1636DE2D20E378E8E3C9983195FB5B32F2B497B6BD5D080BF66C5C4E14611691E98A705367327071574DE21CD0D14A6E8E9C9B1FC72B916258DD92D9F2A0B718192A86810E50A97BF6A7F5F63D562E9EFA23B5004CBB1504C6CEB340E0274C4C1B455916B9B4F3EA8BBC4EEB872B7EADD6137FDDE5AEA236519FC19C9669EA3544587D3C1BF6643C5D128E1BBF464D7039754C27F944D3512E856C1F3142D1F9891AAFFBC28B82800A6D930473C5900920207942CA7899EC18528E228BFE';
//    const der = Hex.decode(HEX_TH);
//    const asn = ASN1.decode(der);
//    console.log('ASN: ' + asn.toPrettyString());

    return HWCrypto.getCertificate({lang: 'en'}).then((response) => {
          const der = Hex.decode(response.hex);
          const asn = ASN1.decode(der);
          console.log('ASN : ' + asn.toPrettyString());
          return asn;
        }, function(err) {
          console.log('getCertificate() failed: ' + err.message);
          return 'CERTIFICATE NOT PRESENT';
      });
  }
}

export default new HWCryptoService();
